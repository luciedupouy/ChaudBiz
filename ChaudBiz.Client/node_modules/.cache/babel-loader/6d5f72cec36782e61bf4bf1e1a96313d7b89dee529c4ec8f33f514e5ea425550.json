{"ast":null,"code":"import React,{useState,useEffect}from'react';import BottomNavbar from'../components/Navbar';import Header from'../components/Header';import'../styles/TodoMateriel.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const TodoMateriel=()=>{const[materiels,setMateriels]=useState([]);const[showPopup,setShowPopup]=useState(false);// État pour afficher ou masquer le pop-up\nuseEffect(()=>{const storedMateriels=localStorage.getItem('materiels');if(storedMateriels){setMateriels(JSON.parse(storedMateriels));}else{fetch('http://localhost:5257/api/materiel/').then(response=>{if(!response.ok){throw new Error('Failed to fetch materiels');}return response.json();}).then(data=>{setMateriels(data);}).catch(error=>{console.error('Error fetching materiels:',error);});}},[]);// Assurez-vous de passer un tableau vide en tant que dépendances pour n'exécuter cet effet qu'une seule fois après le montage initial\nconst commanderMateriel=async id=>{try{const response=await fetch(\"http://localhost:5257/api/materiel/\".concat(id),{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify({materielId:id,etat:1})// Envoyer l'état mis à jour\n});if(response.ok){setShowPopup(true);// Afficher le pop-up après avoir envoyé la requête avec succès\n// Mettre à jour l'état du matériel localement\nsetMateriels(prevMateriels=>prevMateriels.map(materiel=>{if(materiel.materielId===id){return{...materiel,etat:1};// Mettre à jour l'état du matériel\n}return materiel;}));}else{console.error('Failed to update matériel status');}}catch(error){console.error('Error updating matériel status',error);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Header,{titre:\"Liste Mat\\xE9riels\"}),/*#__PURE__*/_jsx(\"div\",{className:\"materiel\",children:materiels.map((materiel,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"outil\",children:[/*#__PURE__*/_jsx(\"span\",{children:materiel.label}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>commanderMateriel(materiel.materielId),children:\"Ajouter\"})]},index))}),/*#__PURE__*/_jsx(BottomNavbar,{}),showPopup&&/*#__PURE__*/_jsx(\"div\",{className:\"popup-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"popup-content\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Votre demande a \\xE9t\\xE9 envoy\\xE9e ! \"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowPopup(false),children:\"Fermer\"})]})})]});};export default TodoMateriel;","map":{"version":3,"names":["React","useState","useEffect","BottomNavbar","Header","jsx","_jsx","jsxs","_jsxs","TodoMateriel","materiels","setMateriels","showPopup","setShowPopup","storedMateriels","localStorage","getItem","JSON","parse","fetch","then","response","ok","Error","json","data","catch","error","console","commanderMateriel","id","concat","method","headers","body","stringify","materielId","etat","prevMateriels","map","materiel","children","titre","className","index","label","onClick"],"sources":["/Users/luciedupouy/chaudbiz/ChaudBiz.Client/src/pages/TodoMateriel.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport BottomNavbar from '../components/Navbar';\nimport Header from '../components/Header';\nimport '../styles/TodoMateriel.css'\n\nconst TodoMateriel = () => {\n    const [materiels, setMateriels] = useState([]);\n    const [showPopup, setShowPopup] = useState(false); // État pour afficher ou masquer le pop-up\n\n    useEffect(() => {\n        const storedMateriels = localStorage.getItem('materiels');\n        if (storedMateriels) {\n            setMateriels(JSON.parse(storedMateriels));\n        } else {\n            fetch('http://localhost:5257/api/materiel/')\n                .then(response => {\n                    if (!response.ok) {\n                        throw new Error('Failed to fetch materiels');\n                    }\n                    return response.json();\n                })\n                .then(data => {\n                    setMateriels(data);\n                })\n                .catch(error => {\n                    console.error('Error fetching materiels:', error);\n                });\n        }\n    }, []); // Assurez-vous de passer un tableau vide en tant que dépendances pour n'exécuter cet effet qu'une seule fois après le montage initial\n\n    const commanderMateriel = async (id) => {\n        try {\n            const response = await fetch(`http://localhost:5257/api/materiel/${id}`, {\n                method: 'PUT',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({ materielId: id, etat: 1 }) // Envoyer l'état mis à jour\n            });\n            if (response.ok) {\n                setShowPopup(true); // Afficher le pop-up après avoir envoyé la requête avec succès\n                // Mettre à jour l'état du matériel localement\n                setMateriels(prevMateriels => \n                    prevMateriels.map(materiel => {\n                        if (materiel.materielId === id) {\n                            return { ...materiel, etat: 1 }; // Mettre à jour l'état du matériel\n                        }\n                        return materiel;\n                    })\n                );\n            } else {\n                console.error('Failed to update matériel status');\n            }\n        } catch (error) {\n            console.error('Error updating matériel status', error);\n        }\n    };\n    \n\n    return (\n        <div >\n            <Header titre=\"Liste Matériels\" />\n            <div className='materiel'>\n                {materiels.map((materiel, index) => (\n                    <div key={index} className=\"outil\">\n                        <span>{materiel.label}</span>\n                        <button onClick={() => commanderMateriel(materiel.materielId)}>Ajouter</button>\n                    </div>\n                ))}\n            </div>\n            <BottomNavbar />\n\n            {/* Pop-up */}\n            {showPopup && (\n                <div className=\"popup-overlay\">\n                    <div className=\"popup-content\">\n                    <p>Votre demande a été envoyée ! </p>\n                    <button onClick={() => setShowPopup(false)}>Fermer</button>\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n};\n\nexport default TodoMateriel;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,CAAAC,YAAY,KAAM,sBAAsB,CAC/C,MAAO,CAAAC,MAAM,KAAM,sBAAsB,CACzC,MAAO,4BAA4B,QAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAEnC,KAAM,CAAAC,YAAY,CAAGA,CAAA,GAAM,CACvB,KAAM,CAACC,SAAS,CAAEC,YAAY,CAAC,CAAGV,QAAQ,CAAC,EAAE,CAAC,CAC9C,KAAM,CAACW,SAAS,CAAEC,YAAY,CAAC,CAAGZ,QAAQ,CAAC,KAAK,CAAC,CAAE;AAEnDC,SAAS,CAAC,IAAM,CACZ,KAAM,CAAAY,eAAe,CAAGC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC,CACzD,GAAIF,eAAe,CAAE,CACjBH,YAAY,CAACM,IAAI,CAACC,KAAK,CAACJ,eAAe,CAAC,CAAC,CAC7C,CAAC,IAAM,CACHK,KAAK,CAAC,qCAAqC,CAAC,CACvCC,IAAI,CAACC,QAAQ,EAAI,CACd,GAAI,CAACA,QAAQ,CAACC,EAAE,CAAE,CACd,KAAM,IAAI,CAAAC,KAAK,CAAC,2BAA2B,CAAC,CAChD,CACA,MAAO,CAAAF,QAAQ,CAACG,IAAI,CAAC,CAAC,CAC1B,CAAC,CAAC,CACDJ,IAAI,CAACK,IAAI,EAAI,CACVd,YAAY,CAACc,IAAI,CAAC,CACtB,CAAC,CAAC,CACDC,KAAK,CAACC,KAAK,EAAI,CACZC,OAAO,CAACD,KAAK,CAAC,2BAA2B,CAAEA,KAAK,CAAC,CACrD,CAAC,CAAC,CACV,CACJ,CAAC,CAAE,EAAE,CAAC,CAAE;AAER,KAAM,CAAAE,iBAAiB,CAAG,KAAO,CAAAC,EAAE,EAAK,CACpC,GAAI,CACA,KAAM,CAAAT,QAAQ,CAAG,KAAM,CAAAF,KAAK,uCAAAY,MAAA,CAAuCD,EAAE,EAAI,CACrEE,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,CACL,cAAc,CAAE,kBACpB,CAAC,CACDC,IAAI,CAAEjB,IAAI,CAACkB,SAAS,CAAC,CAAEC,UAAU,CAAEN,EAAE,CAAEO,IAAI,CAAE,CAAE,CAAC,CAAE;AACtD,CAAC,CAAC,CACF,GAAIhB,QAAQ,CAACC,EAAE,CAAE,CACbT,YAAY,CAAC,IAAI,CAAC,CAAE;AACpB;AACAF,YAAY,CAAC2B,aAAa,EACtBA,aAAa,CAACC,GAAG,CAACC,QAAQ,EAAI,CAC1B,GAAIA,QAAQ,CAACJ,UAAU,GAAKN,EAAE,CAAE,CAC5B,MAAO,CAAE,GAAGU,QAAQ,CAAEH,IAAI,CAAE,CAAE,CAAC,CAAE;AACrC,CACA,MAAO,CAAAG,QAAQ,CACnB,CAAC,CACL,CAAC,CACL,CAAC,IAAM,CACHZ,OAAO,CAACD,KAAK,CAAC,kCAAkC,CAAC,CACrD,CACJ,CAAE,MAAOA,KAAK,CAAE,CACZC,OAAO,CAACD,KAAK,CAAC,gCAAgC,CAAEA,KAAK,CAAC,CAC1D,CACJ,CAAC,CAGD,mBACInB,KAAA,QAAAiC,QAAA,eACInC,IAAA,CAACF,MAAM,EAACsC,KAAK,CAAC,oBAAiB,CAAE,CAAC,cAClCpC,IAAA,QAAKqC,SAAS,CAAC,UAAU,CAAAF,QAAA,CACpB/B,SAAS,CAAC6B,GAAG,CAAC,CAACC,QAAQ,CAAEI,KAAK,gBAC3BpC,KAAA,QAAiBmC,SAAS,CAAC,OAAO,CAAAF,QAAA,eAC9BnC,IAAA,SAAAmC,QAAA,CAAOD,QAAQ,CAACK,KAAK,CAAO,CAAC,cAC7BvC,IAAA,WAAQwC,OAAO,CAAEA,CAAA,GAAMjB,iBAAiB,CAACW,QAAQ,CAACJ,UAAU,CAAE,CAAAK,QAAA,CAAC,SAAO,CAAQ,CAAC,GAFzEG,KAGL,CACR,CAAC,CACD,CAAC,cACNtC,IAAA,CAACH,YAAY,GAAE,CAAC,CAGfS,SAAS,eACNN,IAAA,QAAKqC,SAAS,CAAC,eAAe,CAAAF,QAAA,cAC1BjC,KAAA,QAAKmC,SAAS,CAAC,eAAe,CAAAF,QAAA,eAC9BnC,IAAA,MAAAmC,QAAA,CAAG,yCAA8B,CAAG,CAAC,cACrCnC,IAAA,WAAQwC,OAAO,CAAEA,CAAA,GAAMjC,YAAY,CAAC,KAAK,CAAE,CAAA4B,QAAA,CAAC,QAAM,CAAQ,CAAC,EACtD,CAAC,CACL,CACR,EACA,CAAC,CAEd,CAAC,CAED,cAAe,CAAAhC,YAAY"},"metadata":{},"sourceType":"module","externalDependencies":[]}
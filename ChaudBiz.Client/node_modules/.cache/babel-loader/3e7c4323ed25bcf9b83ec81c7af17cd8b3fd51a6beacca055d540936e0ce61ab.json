{"ast":null,"code":"import React,{useState}from'react';import{Link,Redirect}from'react-router-dom';import logo from'../logo.jpg';import axios from'axios';import'../styles/Global.css';// Importez le style global\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Login=()=>{const[email,setEmail]=useState('');const[password,setPassword]=useState('');const[loggedIn,setLoggedIn]=useState(false);const[role,setRole]=useState('');const[error,setError]=useState('');const handleLogin=async()=>{try{var _response$data;const response=await axios.post('http://localhost:5257/api/utilisateur/login',{MailUtilisateur:email,Mdp:password});console.log(response);const userRole=(_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.role;console.log('Role récupéré:',userRole);if(userRole==='ADMINISTRATEUR'){setRole('ADMINISTRATEUR');}else if(userRole==='OUVRIER'){setRole('OUVRIER');}setLoggedIn(true);}catch(error){console.error('Erreur de connexion:',error.response?error.response.data:error.message);setError('Identifiant ou mot de passe incorrect.');}};if(loggedIn){if(role==='ADMINISTRATEUR'){return/*#__PURE__*/_jsx(Redirect,{to:\"/accueila\"});}else if(role==='OUVRIER'){return/*#__PURE__*/_jsx(Redirect,{to:\"/accueilo\"});}}return/*#__PURE__*/_jsxs(\"div\",{className:\"login\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"logo\",src:logo,alt:\"logo\"}),/*#__PURE__*/_jsx(\"h1\",{children:\"Connexion\"}),/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:\"Adresse e-mail\",value:email,onChange:e=>setEmail(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Mot de passe\",value:password,onChange:e=>setPassword(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleLogin,children:\"Connexion\"})]}),/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},children:error}),/*#__PURE__*/_jsx(Link,{className:\"Link\",to:\"/inscription\",children:\"S'inscrire\"})]});};export default Login;","map":{"version":3,"names":["React","useState","Link","Redirect","logo","axios","jsx","_jsx","jsxs","_jsxs","Login","email","setEmail","password","setPassword","loggedIn","setLoggedIn","role","setRole","error","setError","handleLogin","_response$data","response","post","MailUtilisateur","Mdp","console","log","userRole","data","message","to","className","children","src","alt","type","placeholder","value","onChange","e","target","onClick","style","color"],"sources":["/Users/luciedupouy/chaudbiz/ChaudBiz.Client/src/pages/Login.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { Link, Redirect } from 'react-router-dom';\nimport logo from '../logo.jpg';\nimport axios from 'axios';\nimport  '../styles/Global.css'; // Importez le style global\n\n\nconst Login = () => {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [loggedIn, setLoggedIn] = useState(false);\n  const [role, setRole] = useState('');\n  const [error, setError] = useState('');\n\n  const handleLogin = async () => {\n    try {\n      const response = await axios.post('http://localhost:5257/api/utilisateur/login', {\n        MailUtilisateur: email,\n        Mdp: password,\n      });\n      console.log(response);\n      const userRole = response.data?.role;\n      console.log('Role récupéré:', userRole);\n\n      if (userRole === 'ADMINISTRATEUR') {\n        setRole('ADMINISTRATEUR');\n      } else if (userRole === 'OUVRIER') {\n        setRole('OUVRIER');\n      }\n\n      setLoggedIn(true);\n    } catch (error) {\n      console.error('Erreur de connexion:', error.response ? error.response.data : error.message);\n      setError('Identifiant ou mot de passe incorrect.');\n    }\n  };\n\n  if (loggedIn) {\n    if (role === 'ADMINISTRATEUR') {\n      return <Redirect to=\"/accueila\" />;\n    } else if (role === 'OUVRIER') {\n      return <Redirect to=\"/accueilo\" />;\n    }\n  }\n\n  return (\n    <div className=\"login\">\n      <img className=\"logo\" src={logo} alt=\"logo\" />\n      <h1>Connexion</h1>\n      <form>\n        <input\n          type=\"email\"\n          placeholder=\"Adresse e-mail\"\n          value={email}\n          onChange={(e) => setEmail(e.target.value)}\n        />\n\n        <input\n          type=\"password\"\n          placeholder=\"Mot de passe\"\n          value={password}\n          onChange={(e) => setPassword(e.target.value)}\n        />\n\n        <button type=\"button\" onClick={handleLogin}>\n          Connexion\n        </button>\n      </form>\n      <p style={{ color: 'red' }}>{error}</p>\n      <Link className=\"Link\" to=\"/inscription\">\n        S'inscrire\n      </Link>\n    </div>\n  );\n};\n\nexport default Login;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}